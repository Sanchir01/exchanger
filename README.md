# Exchanger Service

Сервис для получения и управления курсами обмена валют.

## Стек технологий

- **Язык:** Go
- **API:** gRPC
- **База данных:** PostgreSQL
- **Кэш:** Redis
- **Контейнеризация:** Docker, Docker Compose
- **Миграции:** goose
- **Конфигурация:** cleanenv

## Запуск проекта

### Локальная разработка

1.  **Клонируйте репозиторий:**

    ```bash
    git clone github.com/Sanchir01/exchanger
    cd exchanger
    ```

2.  **Запустите зависимости:**
    Для запуска PostgreSQL и Redis выполните:

    ```bash
    make docker
    ```

3.  **Примените миграции:**

    ```bash
    make migrations-up
    ```

4.  **Запустите приложение:**
    Создайте файл `.env.prod` на основе `.env.dev` (если он есть) или заполните переменные окружения. Затем выполните:
    ```bash
    make run
    ```
    Сервис будет доступен на порту, указанном в `config/dev.yaml`.

### Production

1.  **Создайте файл `.env.prod`:**
    Этот файл должен содержать переменные для подключения к производственной базе данных.

2.  **Запустите проект с помощью Docker Compose:**

    ```bash
    make compose-prod
    ```

    Эта команда соберет образ приложения и запустит все необходимые сервисы.

3.  **Примените миграции для production:**
    ```bash
    make migrations-up-prod
    ```

## Makefile Команды

- `make build`: Собрать бинарный файл приложения.
- `make run`: Собрать и запустить приложение локально.
- `make docker`: Запустить PostgreSQL и Redis в Docker (для разработки).
- `make compose-prod`: Собрать и запустить все сервисы для production.
- `make migrations-up`: Применить миграции для dev-окружения.
- `make migrations-down`: Откатить последнюю миграцию для dev-окружения.
- `make migrations-status`: Показать статус миграций для dev-окружения.
- `make migrations-new MIGRATION_NAME="your_migration_name"`: Создать новый файл миграции.
- `make migrations-up-prod`: Применить миграции для prod-окружения.

## Конфигурация

Проект использует библиотеку `cleanenv` для управления конфигурацией.

- Файлы конфигурации находятся в директории `/config`.
- `dev.yaml`: для окружения разработки.
- `prod.yaml`: для production-окружения.

Приложение загружает конфигурацию в зависимости от установленных переменных окружения.
